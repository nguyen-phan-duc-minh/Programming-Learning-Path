from marshmallow import Schema, fields, validate

class UserSchema(Schema):
    id = fields.Int(dump_only=True)
    email = fields.Email(required=True)
    first_name = fields.Str(required=True, validate=validate.Length(min=1, max=50))
    last_name = fields.Str(required=True, validate=validate.Length(min=1, max=50))
    role = fields.Str(dump_only=True)
    is_active = fields.Bool(dump_only=True)
    created_at = fields.DateTime(dump_only=True)
    last_login = fields.DateTime(dump_only=True)

class SkillProfileSchema(Schema):
    id = fields.Int(dump_only=True)
    user_id = fields.Int(required=True)
    programming_languages = fields.List(fields.Str())
    experience_level = fields.Str()
    learning_goals = fields.List(fields.Str())
    preferred_learning_style = fields.Str()
    available_hours_per_week = fields.Int()
    career_goal = fields.Str()
    current_knowledge = fields.Dict()
    created_at = fields.DateTime(dump_only=True)
    updated_at = fields.DateTime(dump_only=True)

class QuizQuestionSchema(Schema):
    id = fields.Int(dump_only=True)
    category = fields.Str(required=True)
    question = fields.Str(required=True)
    options = fields.List(fields.Str(), required=True)
    correct_answer = fields.Int(required=True)
    difficulty = fields.Str(required=True)
    explanation = fields.Str()

class QuizResultSchema(Schema):
    id = fields.Int(dump_only=True)
    user_id = fields.Int(required=True)
    category = fields.Str(required=True)
    score = fields.Float(required=True)
    total_questions = fields.Int(required=True)
    correct_answers = fields.Int(required=True)
    time_taken = fields.Int()
    answers = fields.Dict()
    completed_at = fields.DateTime(dump_only=True)

class RoadmapTemplateSchema(Schema):
    id = fields.Int(dump_only=True)
    name = fields.Str(required=True)
    description = fields.Str()
    target_role = fields.Str(required=True)
    difficulty_level = fields.Str(required=True)
    estimated_duration_weeks = fields.Int()
    skills_required = fields.List(fields.Str())
    milestones = fields.Dict()
    created_at = fields.DateTime(dump_only=True)

class UserRoadmapSchema(Schema):
    id = fields.Int(dump_only=True)
    user_id = fields.Int(required=True)
    template_id = fields.Int(required=True)
    customized_content = fields.Dict()
    progress_percentage = fields.Float()
    current_milestone = fields.Str()
    estimated_completion_date = fields.Date()
    created_at = fields.DateTime(dump_only=True)
    updated_at = fields.DateTime(dump_only=True)

class ResourceSchema(Schema):
    id = fields.Int(dump_only=True)
    title = fields.Str(required=True)
    description = fields.Str()
    type = fields.Str(required=True)
    category = fields.Str(required=True)
    difficulty_level = fields.Str()
    url = fields.Url()
    content = fields.Str()
    estimated_time_minutes = fields.Int()
    tags = fields.List(fields.Str())
    rating = fields.Float()
    created_at = fields.DateTime(dump_only=True)

class TaskProgressSchema(Schema):
    id = fields.Int(dump_only=True)
    user_id = fields.Int(required=True)
    roadmap_id = fields.Int(required=True)
    task_name = fields.Str(required=True)
    task_type = fields.Str(required=True)
    status = fields.Str(required=True)
    progress_percentage = fields.Float()
    time_spent_minutes = fields.Int()
    notes = fields.Str()
    completed_at = fields.DateTime()
    created_at = fields.DateTime(dump_only=True)
    updated_at = fields.DateTime(dump_only=True)